
# 单向双向

mobexler：

运行即可，自动调试的：

<img width="721" height="462" alt="image" src="https://github.com/user-attachments/assets/e708266f-8c7b-4dd5-aa50-7564806ead78" />


直接上传apk文件去，自动反编译分析，提取一些信息。反编译如果有壳，就反编译的不全。

![image-20250405144005058](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613101.png)

可能存在双向验证、就需要你脱壳后反编译找到里面的证书key导入，才能进行后续抓包操作：

![image-20250405144243295](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613102.png)

双向绕过：

需要将app的证书导入到bp中，app反编译找到证书，密钥来导入证书（能反编译，如果有壳就比较难，有证书文件）

![image-20250405144615335](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613103.png)

### 绕过方法：

探探的代理证书检测。

夜神的xp框架安装。

开始绕双向验证：先关闭通杀。配置对应frida   firda-tools版本

![image-20250403110942954](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613104.png)

与模拟器建立连接，需要启动模拟器frida，配置

真机是另一种配置方式

![image-20250403135536820](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613105.png)

 配置firda环境

![image-20250405170152741](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613106.png)

adb.exe：主机和模拟器之间连接用的。将下载的frida文件解压后放到对应的模拟器的adb.exe目录下。这里夜神是nox_adb.exe。
<img width="811" height="251" alt="image" src="https://github.com/user-attachments/assets/4c8502b5-12ec-469c-9a68-b7b52cbfa752" />


做好转发：

![image-20250405173541687](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613108.png)

#### 方案1：

Firda+r0capture+WireShark   

这个方案比较简单，配置好就能抓到，但是WireShark 不方便，所以还是方案2比较合适测试。

![image-20250403135616424](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613109.png)

安装r0capture即可，配置好，真机下载另一个配置。

python r0capture.py -U -f com.well.likes -p tantan.pcap

![image-20250405202647861](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613110.png)



无论哪个方案都要看这3个好着没；

1、运行模拟器里的frida 	2、3、看与模拟器连接是否正常。 	、

最后是看你的frida的版本是否和上传到模拟器上面的frida版本一致，这里翻车了很久

![image-20250405202939617](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613111.png)

![image-20250405203224351](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613112.png)

#### 方案2：

Firda+HOOK-JS+BurpSuite

需要准备好js，hook技术

将js文件放到模拟器的目录下，利用Firda技术配合代理和js文件（hook）成功抓取数据包到bp中。

![image-20250403135728385](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613113.png)

FridaScripts-main 主要是这个技术里面的js包。

s![image-20250405203525685](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613114.png)

frida  -U  -f  com.p1.mobile.putong  -l  SSLUnpinning.js    	com.well.likes	com.p1.mobile.putong

![image-20250405213212122](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613115.png)

利用Firda技术绕王者营地，记住要开启模拟器那边的Firda进程。翻车（xp框架容易搞崩app或者模拟器）：



测试抖音，比较困难，通杀方案也抓不全

这个方法都是先试一试上面单向的能不能行，不行再用这个方法。



## IOS

IOS端-双向认证-SSL Kill switch 2

因为证书是在apk包里面，所以我们直接解压，找到证书导入bp，但是需要密码，需要反编译，因为有壳，所以这里我们是没法绕过的。

直接解压apk文件    一般看的是里面的assets和res文件     再里面找到apk对应的证书。

![image-20250403140532904](https://cdn.jsdelivr.net/gh/maybeyjb/blue-team/img/202506161613116.png)

使用工具对目标apk进行反编译尝试，使用frida的另一个模块尝试脱壳。

使用对应的Dump模块进行脱壳的时候，需要进去输入对应的命令，这里xd不会，，，，，，
